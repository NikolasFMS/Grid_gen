<!DOCTYPE html>
<html lang="ru">

<head>
    <meta charset="UTF-8" />
    <title>–ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º–∞—è —Å–µ—Ç–∫–∞ —Å –ø–∞—Ç—Ç–µ—Ä–Ω–æ–º</title>
    <style>
        body {
            font-family: sans-serif;
            margin: 20px;
        }

        canvas {
            border: 1px solid #000;
            max-width: 100%;
            height: auto;
            display: block;
            margin-top: 20px;
        }

        .controls {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
        }

        .controls label {
            display: flex;
            flex-direction: column;
            font-size: 14px;
        }

        .buttons {
            margin-top: 10px;
        }

        input[type="number"],
        input[type="color"],
        input[type="text"] {
            width: 120px;
        }

        .convert-info {
            font-size: 12px;
            color: #555;
            margin-top: 5px;
        }
    </style>
</head>

<body>
    <h2>–°–æ–∑–¥–∞–Ω–∏–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è —Å —Å–µ—Ç–∫–æ–π</h2>
    <div class="controls">
        <label> –®–∏—Ä–∏–Ω–∞ (px): <input type="number" id="imgWidth" value="6000" /> <span class="convert-info"
                id="imgWidthCm"></span> </label>
        <label> –í—ã—Å–æ—Ç–∞ (px): <input type="number" id="imgHeight" value="6000" /> <span class="convert-info"
                id="imgHeightCm"></span> </label>
        <label> DPI (–¥–ª—è –∏–Ω—Ñ–æ): <input type="number" id="dpi" value="400" /> <span class="convert-info"
                id="dpiInfo"></span> </label>
        <label> –ü–∞—Ç—Ç–µ—Ä–Ω —à–∞–≥–æ–≤ (—á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é, px): <input type="text" id="patternSteps" value="500,50" /> <span
                class="convert-info" id="patternStepsCm"></span> </label>
        <label> –¶–≤–µ—Ç —Ç–æ–Ω–∫–æ–π –ª–∏–Ω–∏–∏: <input type="color" id="thinColor" value="#cccccc" /> </label>
        <label> –¶–≤–µ—Ç —Ç–æ–ª—Å—Ç–æ–π –ª–∏–Ω–∏–∏: <input type="color" id="boldColor" value="#000000" /> </label>
        <label> –¢–æ–ª—â–∏–Ω–∞ —Ç–æ–Ω–∫–æ–π –ª–∏–Ω–∏–∏ (px): <input type="number" id="thinWidth" value="1" /> <span class="convert-info"
                id="thinWidthCm"></span> </label>
        <label> –¢–æ–ª—â–∏–Ω–∞ —Ç–æ–ª—Å—Ç–æ–π –ª–∏–Ω–∏–∏ (px): <input type="number" id="boldWidth" value="3" /> <span class="convert-info"
                id="boldWidthCm"></span> </label>
    </div>
    <div class="buttons">
        <button onclick="generateGrid()">üîÑ –û–±–Ω–æ–≤–∏—Ç—å</button>
        <button onclick="download()">üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å PNG</button>
        <button onclick="resetDefaults()">‚ôªÔ∏è –°–±—Ä–æ—Å–∏—Ç—å</button>
    </div>
    <canvas id="gridCanvas"></canvas>
    <script>
        const canvas = document.getElementById("gridCanvas");
        const ctx = canvas.getContext("2d");

        // –§—É–Ω–∫—Ü–∏—è –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏ –ø–∏–∫—Å–µ–ª–µ–π –≤ —Å–∞–Ω—Ç–∏–º–µ—Ç—Ä—ã
        function pixelsToCm(pixels, dpi) {
            return ((pixels / dpi) * 2.54).toFixed(2);
        }

        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –≤—Å–µ—Ö –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–π
        function updateConversions() {
            const dpi = parseInt(document.getElementById("dpi").value) || 400;

            const imgWidth = parseInt(document.getElementById("imgWidth").value);
            document.getElementById("imgWidthCm").textContent = `${pixelsToCm(imgWidth, dpi)} —Å–º`;

            const imgHeight = parseInt(document.getElementById("imgHeight").value);
            document.getElementById("imgHeightCm").textContent = `${pixelsToCm(imgHeight, dpi)} —Å–º`;

            document.getElementById("dpiInfo").textContent = "DPI –≤–ª–∏—è–µ—Ç –Ω–∞ –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—é";

            const patternSteps = parsePattern(document.getElementById("patternSteps").value);
            const patternStepsCm = patternSteps.map(step => pixelsToCm(step, dpi)).join(", ");
            document.getElementById("patternStepsCm").textContent = `${patternStepsCm} —Å–º`;

            const thinWidth = parseFloat(document.getElementById("thinWidth").value);
            document.getElementById("thinWidthCm").textContent = `${pixelsToCm(thinWidth, dpi)} —Å–º`;

            const boldWidth = parseFloat(document.getElementById("boldWidth").value);
            document.getElementById("boldWidthCm").textContent = `${pixelsToCm(boldWidth, dpi)} —Å–º`;
        }

        function parsePattern(input) {
            return input
                .split(',')
                .map(val => parseInt(val.trim()))
                .filter(val => !isNaN(val) && val > 0);
        }

        function drawLines(width, height, steps, thinColor, thinWidth, boldColor, boldWidth) {
            const thinStep = 50;
            let posX = 0, posY = 0;

            while (posX < width) {
                ctx.beginPath();
                ctx.strokeStyle = thinColor;
                ctx.lineWidth = thinWidth;
                ctx.moveTo(posX, 0);
                ctx.lineTo(posX, height);
                ctx.stroke();
                posX += thinStep;
            }

            while (posY < height) {
                ctx.beginPath();
                ctx.strokeStyle = thinColor;
                ctx.lineWidth = thinWidth;
                ctx.moveTo(0, posY);
                ctx.lineTo(width, posY);
                ctx.stroke();
                posY += thinStep;
            }

            posX = 0;
            posY = 0;
            let i = 0;

            while (posX < width) {
                const step = steps[i % steps.length];
                posX += step;
                ctx.beginPath();
                ctx.strokeStyle = boldColor;
                ctx.lineWidth = boldWidth;
                ctx.moveTo(posX, 0);
                ctx.lineTo(posX, height);
                ctx.stroke();
                i++;
            }

            i = 0;
            while (posY < height) {
                const step = steps[i % steps.length];
                posY += step;
                ctx.beginPath();
                ctx.strokeStyle = boldColor;
                ctx.lineWidth = boldWidth;
                ctx.moveTo(0, posY);
                ctx.lineTo(width, posY);
                ctx.stroke();
                i++;
            }
        }

        function generateGrid() {
            const width = parseInt(document.getElementById("imgWidth").value);
            const height = parseInt(document.getElementById("imgHeight").value);
            const patternSteps = parsePattern(document.getElementById("patternSteps").value);
            const thinColor = document.getElementById("thinColor").value;
            const boldColor = document.getElementById("boldColor").value;
            const thinWidth = parseFloat(document.getElementById("thinWidth").value);
            const boldWidth = parseFloat(document.getElementById("boldWidth").value);

            if (patternSteps.length === 0) {
                alert("–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, —É–∫–∞–∂–∏ —Ö–æ—Ç—è –±—ã –æ–¥–∏–Ω —à–∞–≥ —Å–µ—Ç–∫–∏.");
                return;
            }

            canvas.width = width;
            canvas.height = height;
            ctx.clearRect(0, 0, width, height);
            drawLines(width, height, patternSteps, thinColor, thinWidth, boldColor, boldWidth);
            updateConversions();
        }

        function download() {
            const link = document.createElement("a");
            link.download = "grid_image.png";
            link.href = canvas.toDataURL("image/png");
            link.click();
        }

        function resetDefaults() {
            document.getElementById("imgWidth").value = 6000;
            document.getElementById("imgHeight").value = 6000;
            document.getElementById("patternSteps").value = "500,50";
            document.getElementById("thinColor").value = "#cccccc";
            document.getElementById("boldColor").value = "#000000";
            document.getElementById("thinWidth").value = 1;
            document.getElementById("boldWidth").value = 3;
            generateGrid();
        }

        // –î–æ–±–∞–≤–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–±—ã—Ç–∏–π –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–π –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –∑–Ω–∞—á–µ–Ω–∏–π
        document.getElementById("imgWidth").addEventListener("input", updateConversions);
        document.getElementById("imgHeight").addEventListener("input", updateConversions);
        document.getElementById("dpi").addEventListener("input", updateConversions);
        document.getElementById("patternSteps").addEventListener("input", updateConversions);
        document.getElementById("thinWidth").addEventListener("input", updateConversions);
        document.getElementById("boldWidth").addEventListener("input", updateConversions);

        window.onload = () => {
            generateGrid();
            updateConversions();
        };
    </script>
</body>

</html>
