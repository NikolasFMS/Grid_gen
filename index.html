<!DOCTYPE html>
<html lang="ru">

<head>
    <meta charset="UTF-8" />
    <title>–ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º–∞—è —Å–µ—Ç–∫–∞ —Å –ø–∞—Ç—Ç–µ—Ä–Ω–æ–º</title>
    <style>
        body {
            font-family: sans-serif;
            margin: 20px;
        }

        canvas {
            border: 1px solid #000;
            max-width: 100%;
            height: auto;
            display: block;
            margin-top: 20px;
        }

        .controls {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
        }

        .controls label {
            display: flex;
            flex-direction: column;
            font-size: 14px;
        }

        .buttons {
            margin-top: 10px;
        }

        input[type="number"],
        input[type="color"],
        input[type="text"] {
            width: 120px;
        }
    </style>
</head>

<body>
    <h2>–°–æ–∑–¥–∞–Ω–∏–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è —Å —Å–µ—Ç–∫–æ–π</h2>
    <div class="controls">
        <label> –®–∏—Ä–∏–Ω–∞ (px): <input type="number" id="imgWidth" value="6000" /> </label>
        <label> –í—ã—Å–æ—Ç–∞ (px): <input type="number" id="imgHeight" value="6000" /> </label>
        <label> DPI (–¥–ª—è –∏–Ω—Ñ–æ): <input type="number" id="dpi" value="400" /> </label>
        <label> –ü–∞—Ç—Ç–µ—Ä–Ω —à–∞–≥–æ–≤ (—á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é, px): <input type="text" id="patternSteps" value="500,50" /> </label>
        <label> –¶–≤–µ—Ç —Ç–æ–Ω–∫–æ–π –ª–∏–Ω–∏–∏: <input type="color" id="thinColor" value="#cccccc" /> </label>
        <label> –¶–≤–µ—Ç —Ç–æ–ª—Å—Ç–æ–π –ª–∏–Ω–∏–∏: <input type="color" id="boldColor" value="#000000" /> </label>
        <label> –¢–æ–ª—â–∏–Ω–∞ —Ç–æ–Ω–∫–æ–π –ª–∏–Ω–∏–∏ (px): <input type="number" id="thinWidth" value="1" /> </label>
        <label> –¢–æ–ª—â–∏–Ω–∞ —Ç–æ–ª—Å—Ç–æ–π –ª–∏–Ω–∏–∏ (px): <input type="number" id="boldWidth" value="3" /> </label>
    </div>
    <div class="buttons">
        <button onclick="generateGrid()">üîÑ –û–±–Ω–æ–≤–∏—Ç—å</button>
        <button onclick="download()">üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å PNG</button>
        <button onclick="resetDefaults()">‚ôªÔ∏è –°–±—Ä–æ—Å–∏—Ç—å</button>
    </div>
    <canvas id="gridCanvas"></canvas>
    <script>
        const canvas = document.getElementById("gridCanvas");
        const ctx = canvas.getContext("2d");

        function parsePattern(input) {
            return input
                .split(',')
                .map(val => parseInt(val.trim()))
                .filter(val => !isNaN(val) && val > 0);
        }

        function drawLines(width, height, steps, thinColor, thinWidth, boldColor, boldWidth) {
            // –°–Ω–∞—á–∞–ª–∞ —Ä–∏—Å—É–µ–º —Ç–æ–Ω–∫–∏–µ –ª–∏–Ω–∏–∏ –∫–∞–∂–¥—ã–µ 50 –ø–∏–∫—Å–µ–ª–µ–π
            const thinStep = 50;
            let posX = 0, posY = 0;

            // –¢–æ–Ω–∫–∏–µ –ª–∏–Ω–∏–∏ –ø–æ X
            while (posX < width) {
                ctx.beginPath();
                ctx.strokeStyle = thinColor;
                ctx.lineWidth = thinWidth;
                ctx.moveTo(posX, 0);
                ctx.lineTo(posX, height);
                ctx.stroke();
                posX += thinStep;
            }

            // –¢–æ–Ω–∫–∏–µ –ª–∏–Ω–∏–∏ –ø–æ Y
            while (posY < height) {
                ctx.beginPath();
                ctx.strokeStyle = thinColor;
                ctx.lineWidth = thinWidth;
                ctx.moveTo(0, posY);
                ctx.lineTo(width, posY);
                ctx.stroke();
                posY += thinStep;
            }

            // –¢–µ–ø–µ—Ä—å —Ä–∏—Å—É–µ–º —Ç–æ–ª—Å—Ç—ã–µ –ª–∏–Ω–∏–∏ –ø–æ –∑–∞–¥–∞–Ω–Ω–æ–º—É –ø–∞—Ç—Ç–µ—Ä–Ω—É
            posX = 0;
            posY = 0;
            let i = 0;

            // –¢–æ–ª—Å—Ç—ã–µ –ª–∏–Ω–∏–∏ –ø–æ X
            while (posX < width) {
                const step = steps[i % steps.length];
                posX += step;
                ctx.beginPath();
                ctx.strokeStyle = boldColor;
                ctx.lineWidth = boldWidth; // –ü—Ä–∏–º–µ–Ω—è–µ–º boldWidth –∫–æ –≤—Å–µ–º –ª–∏–Ω–∏—è–º –≤ –ø–∞—Ç—Ç–µ—Ä–Ω–µ (–∏ 500, –∏ 50)
                ctx.moveTo(posX, 0);
                ctx.lineTo(posX, height);
                ctx.stroke();
                i++;
            }

            // –¢–æ–ª—Å—Ç—ã–µ –ª–∏–Ω–∏–∏ –ø–æ Y
            i = 0;
            while (posY < height) {
                const step = steps[i % steps.length];
                posY += step;
                ctx.beginPath();
                ctx.strokeStyle = boldColor;
                ctx.lineWidth = boldWidth; // –ü—Ä–∏–º–µ–Ω—è–µ–º boldWidth –∫–æ –≤—Å–µ–º –ª–∏–Ω–∏—è–º –≤ –ø–∞—Ç—Ç–µ—Ä–Ω–µ (–∏ 500, –∏ 50)
                ctx.moveTo(0, posY);
                ctx.lineTo(width, posY);
                ctx.stroke();
                i++;
            }
        }

        function generateGrid() {
            const width = parseInt(document.getElementById("imgWidth").value);
            const height = parseInt(document.getElementById("imgHeight").value);
            const patternSteps = parsePattern(document.getElementById("patternSteps").value);
            const thinColor = document.getElementById("thinColor").value;
            const boldColor = document.getElementById("boldColor").value;
            const thinWidth = parseFloat(document.getElementById("thinWidth").value);
            const boldWidth = parseFloat(document.getElementById("boldWidth").value);

            if (patternSteps.length === 0) {
                alert("–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, —É–∫–∞–∂–∏ —Ö–æ—Ç—è –±—ã –æ–¥–∏–Ω —à–∞–≥ —Å–µ—Ç–∫–∏.");
                return;
            }

            canvas.width = width;
            canvas.height = height;
            ctx.clearRect(0, 0, width, height);
            drawLines(width, height, patternSteps, thinColor, thinWidth, boldColor, boldWidth);
        }

        function download() {
            const link = document.createElement("a");
            link.download = "grid_image.png";
            link.href = canvas.toDataURL("image/png");
            link.click();
        }

        function resetDefaults() {
            document.getElementById("imgWidth").value = 6000;
            document.getElementById("imgHeight").value = 6000;
            document.getElementById("patternSteps").value = "500,50";
            document.getElementById("thinColor").value = "#cccccc";
            document.getElementById("boldColor").value = "#000000";
            document.getElementById("thinWidth").value = 1;
            document.getElementById("boldWidth").value = 3;
            generateGrid();
        }

        window.onload = generateGrid;
    </script>
</body>

</html>
